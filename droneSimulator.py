import mysql.connector
import time
import random

db = mysql.connector.connect(
    host="localhost",
    user="testuser",
    password="test123",
    database='aerodronedb')
if db.is_connected():
    print("Successfully connected to Drone Central Database")

print("Simulating Drone Tracks")

cursor = db.cursor(buffered=True)

def updateTracks(drone, lat, lon):
    query = f"INSERT INTO `dronelogs` ( `droneID`, `lat`, `long`) VALUES ('{drone}','{lat}', '{lon}');"
    cursor.execute(query)
    db.commit()
    print(f"Drone {drone} - lat: {lat}, long: {lon}")

def main():
    track1 = [[15.106827085388732, 120.60650581228775],[15.114616206771203, 120.60847991799486],[15.11991927471293, 120.60187095541016],\
            [15.126382209459088, 120.5967211144351],[15.136324801177723, 120.58642143248493],[15.129862169628817, 120.57500595165683],\
            [15.12621649564483, 120.58333152789987],[15.115527681009745, 120.5962919610205],[15.107490000466996, 120.60135597131267]]
    track2 = [[15.144534128280691, 120.60012542864429],[15.142654480599532, 120.59646590746271],[15.13954330294189, 120.59411575624522],\
            [15.136075582313088, 120.59159773708359],[15.132672623702073, 120.59028836711956],[15.131505882328243, 120.59377859994477],\
                [15.128621411057145, 120.59586016249736],[15.130112266252729, 120.59784100423785],[15.137089227342006, 120.59723153626693]]
    track3 = [[15.03744986530496, 120.68179971838573],[15.053824734821333, 120.66021918172922],[15.071314682456958, 120.64480451268882],\
            [15.087314864692548, 120.6317020440045],[15.101825616318921, 120.61937030877218],[15.116127922525628, 120.60669634017042],\
                [15.125742689352005, 120.59759042541131],[15.13164868703517, 120.59367772780637],[15.131099298857583, 120.5902630100775]]
    track4 = [[15.168682883846646, 120.58548007611084],[15.165452086812124, 120.59011493298841],[15.161392810287747, 120.59131656254927],\
            [15.150788618138256, 120.59243236179408],[15.141509514159527, 120.59663806525707],[15.138526858648925, 120.59380565272076],\
                [15.134301358102402, 120.58994327198944],[15.138526858648925, 120.5887416424286],[15.144906376206386, 120.58839831969692]]
    track5 = [[15.115887449620521, 120.56577671970672], [15.123579307129441, 120.57189475614312],[15.128661274172691, 120.57466921452705],\
            [15.133399755275653, 120.56890687788348],[15.130034757861878, 120.57523833419557],[15.126257656297698, 120.58327714951318],\
                [15.118428540550376, 120.5914582447479],[15.12337327886871, 120.59494410271748],[15.13127088557073, 120.59024886545234]]
    while True:
        for i in range(9):
            updateTracks('0001',track1[i][0],track1[i][1])
            updateTracks('0002',track2[i][0],track2[i][1])
            updateTracks('0003',track3[i][0],track3[i][1])
            updateTracks('0004',track4[i][0],track4[i][1])
            updateTracks('0005',track5[i][0],track5[i][1])
            time.sleep(5)

if __name__ == "__main__":
    main()